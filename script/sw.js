const VERSION = '1.0.2'

const contentToCache = [
    '/',
    '/index.html',
    '/assets/audio',
    '/assets/audio/action/action-1.mp3',
    '/assets/audio/action/action-2.mp3',
    '/assets/audio/action/action-3.mp3',
    '/assets/audio/action/action-4.mp3',
    '/assets/audio/action/action-5.mp3',
    '/assets/audio/break-crate.mp3',
    '/assets/audio/empty-weapon.mp3',
    '/assets/audio/explosion.mp3',
    '/assets/audio/flashbang.mp3',
    '/assets/audio/footstep.mp3',
    '/assets/audio/pickup/ammo-pickup.mp3',
    '/assets/audio/pickup/coin-pickup.mp3',
    '/assets/audio/pickup/gun-pickup.mp3',
    '/assets/audio/pickup/pickup.mp3',
    '/assets/audio/ui/click.mp3',
    '/assets/audio/ui/hover.mp3',
    '/assets/audio/ui/save.mp3',
    '/assets/audio/ui/serenity.mp3',
    '/assets/audio/ui/stash.mp3',
    '/assets/audio/ui/trade.mp3',
    '/assets/audio/ui/upgrade.mp3',
    '/assets/audio/weapon/equip/arcticwarfare.mp3',
    '/assets/audio/weapon/equip/benellim4.mp3',
    '/assets/audio/weapon/equip/glock.mp3',
    '/assets/audio/weapon/equip/m1911.mp3',
    '/assets/audio/weapon/equip/mauser.mp3',
    '/assets/audio/weapon/equip/mp5k.mp3',
    '/assets/audio/weapon/equip/p90.mp3',
    '/assets/audio/weapon/equip/parkerhalem85.mp3',
    '/assets/audio/weapon/equip/ppsh.mp3',
    '/assets/audio/weapon/equip/remington1858.mp3',
    '/assets/audio/weapon/equip/remington870.mp3',
    '/assets/audio/weapon/equip/revolver.mp3',
    '/assets/audio/weapon/equip/spas.mp3',
    '/assets/audio/weapon/equip/steyrssg69.mp3',
    '/assets/audio/weapon/equip/uzi.mp3',
    '/assets/audio/weapon/reload/arcticwarfare.mp3',
    '/assets/audio/weapon/reload/benellim4.mp3',
    '/assets/audio/weapon/reload/glock.mp3',
    '/assets/audio/weapon/reload/m1911.mp3',
    '/assets/audio/weapon/reload/mauser.mp3',
    '/assets/audio/weapon/reload/mp5k.mp3',
    '/assets/audio/weapon/reload/p90.mp3',
    '/assets/audio/weapon/reload/parkerhalem85.mp3',
    '/assets/audio/weapon/reload/ppsh.mp3',
    '/assets/audio/weapon/reload/remington1858.mp3',
    '/assets/audio/weapon/reload/remington870.mp3',
    '/assets/audio/weapon/reload/revolver.mp3',
    '/assets/audio/weapon/reload/spas.mp3',
    '/assets/audio/weapon/reload/steyrssg69.mp3',
    '/assets/audio/weapon/reload/uzi.mp3',
    '/assets/audio/weapon/shoot/arcticwarfare.mp3',
    '/assets/audio/weapon/shoot/benellim4.mp3',
    '/assets/audio/weapon/shoot/glock.mp3',
    '/assets/audio/weapon/shoot/m1911.mp3',
    '/assets/audio/weapon/shoot/mauser.mp3',
    '/assets/audio/weapon/shoot/mp5k.mp3',
    '/assets/audio/weapon/shoot/p90.mp3',
    '/assets/audio/weapon/shoot/parkerhalem85.mp3',
    '/assets/audio/weapon/shoot/ppsh.mp3',
    '/assets/audio/weapon/shoot/remington1858.mp3',
    '/assets/audio/weapon/shoot/remington870.mp3',
    '/assets/audio/weapon/shoot/revolver.mp3',
    '/assets/audio/weapon/shoot/spas.mp3',
    '/assets/audio/weapon/shoot/steyrssg69.mp3',
    '/assets/audio/weapon/shoot/uzi.mp3',
    '/assets/fonts/JosefinSlab.ttf',
    '/assets/fonts/kalam.ttf',
    '/assets/images/adrenaline.png',
    '/assets/images/antidote.png',
    '/assets/images/arcticwarfare.png',
    '/assets/images/armor.png',
    '/assets/images/bandage.png',
    '/assets/images/benellim4.png',
    '/assets/images/bluevaccine.png',
    '/assets/images/bluevirus.png',
    '/assets/images/cancel.png',
    '/assets/images/cart.png',
    '/assets/images/chev-down.png',
    '/assets/images/chev-left.png',
    '/assets/images/chev-right.png',
    '/assets/images/chev-up.png',
    '/assets/images/coin.png',
    '/assets/images/computer.png',
    '/assets/images/crate.png',
    '/assets/images/energydrink.png',
    '/assets/images/explosion.png',
    '/assets/images/fire.webp',
    '/assets/images/flashbang.png',
    '/assets/images/github.png',
    '/assets/images/glock.png',
    '/assets/images/gmail.png',
    '/assets/images/greenvaccine.png',
    '/assets/images/greenvirus.png',
    '/assets/images/grenade.png',
    '/assets/images/gun-fire.png',
    '/assets/images/harddrive.png',
    '/assets/images/heal.png',
    '/assets/images/healthpotion.png',
    '/assets/images/icon-desktop.png',
    '/assets/images/icon-mobile.png',
    '/assets/images/instagram.png',
    '/assets/images/interact.png',
    '/assets/images/inventory.png',
    '/assets/images/key-1.png',
    '/assets/images/key-10.png',
    '/assets/images/key-11.png',
    '/assets/images/key-12.png',
    '/assets/images/key-13.png',
    '/assets/images/key-14.png',
    '/assets/images/key-15.png',
    '/assets/images/key-2.png',
    '/assets/images/key-3.png',
    '/assets/images/key-4.png',
    '/assets/images/key-5.png',
    '/assets/images/key-6.png',
    '/assets/images/key-7.png',
    '/assets/images/key-8.png',
    '/assets/images/key-9.png',
    '/assets/images/lever.png',
    '/assets/images/lighter.png',
    '/assets/images/linkedin.png',
    '/assets/images/luckpills.png',
    '/assets/images/m1911.png',
    '/assets/images/magnumAmmo.png',
    '/assets/images/mauser.png',
    '/assets/images/mp5k.png',
    '/assets/images/note.png',
    '/assets/images/p90.png',
    '/assets/images/parkerhalem85.png',
    '/assets/images/pause.png',
    '/assets/images/pistolAmmo.png',
    '/assets/images/poison.png',
    '/assets/images/pouch.png',
    '/assets/images/ppsh.png',
    '/assets/images/profile.png',
    '/assets/images/purplevaccine.png',
    '/assets/images/purplevirus.png',
    '/assets/images/redvaccine.png',
    '/assets/images/redvirus.png',
    '/assets/images/reload.png',
    '/assets/images/remington1858.png',
    '/assets/images/remington870.png',
    '/assets/images/revolver.png',
    '/assets/images/rifleAmmo.png',
    '/assets/images/screenshot-mobile.png',
    '/assets/images/screenshot.png',
    '/assets/images/shotgunShells.png',
    '/assets/images/slot-1.png',
    '/assets/images/slot-2.png',
    '/assets/images/slot-3.png',
    '/assets/images/slot-4.png',
    '/assets/images/smgAmmo.png',
    '/assets/images/spas.png',
    '/assets/images/speaker.png',
    '/assets/images/splatter.png',
    '/assets/images/sprint.png',
    '/assets/images/stash.png',
    '/assets/images/steyrssg69.png',
    '/assets/images/stick.png',
    '/assets/images/throw.png',
    '/assets/images/torch.png',
    '/assets/images/upgrade.png',
    '/assets/images/uzi.png',
    '/assets/images/vendingMachine.png',
    '/assets/images/yellowvaccine.png',
    '/assets/images/yellowvirus.png',
    '/manifest.json',
    '/package.json',
    '/script/actions.js',
    '/script/angle-manager.js',
    '/script/computer.js',
    '/script/controls.js',
    '/script/data-manager.js',
    '/script/dialogue-manager.js',
    '/script/elements.js',
    '/script/enemy/enemy-constants.js',
    '/script/enemy/enemy-factory.js',
    '/script/enemy/service/abstract/angle.js',
    '/script/enemy/service/abstract/injury.js',
    '/script/enemy/service/abstract/movement.js',
    '/script/enemy/service/abstract/notification.js',
    '/script/enemy/service/abstract/offence.js',
    '/script/enemy/service/abstract/path-finding.js',
    '/script/enemy/service/abstract/vision.js',
    '/script/enemy/service/grabber/grab.js',
    '/script/enemy/service/grabber/injury.js',
    '/script/enemy/service/grabber/movement.js',
    '/script/enemy/service/normal/chase.js',
    '/script/enemy/service/normal/guess-search.js',
    '/script/enemy/service/normal/investigate.js',
    '/script/enemy/service/normal/lost.js',
    '/script/enemy/service/normal/return.js',
    '/script/enemy/service/ranger/shooting.js',
    '/script/enemy/service/scorcher/movement.js',
    '/script/enemy/service/scorcher/shooting.js',
    '/script/enemy/service/spiker/investigate.js',
    '/script/enemy/service/spiker/lost.js',
    '/script/enemy/service/spiker/movement.js',
    '/script/enemy/service/spiker/vision.js',
    '/script/enemy/service/stinger/movement.js',
    '/script/enemy/service/stinger/shooting.js',
    '/script/enemy/service/tracker/chase.js',
    '/script/enemy/service/tracker/guess-search.js',
    '/script/enemy/service/tracker/lost.js',
    '/script/enemy/service/tracker/movement.js',
    '/script/enemy/service/tracker/notification.js',
    '/script/enemy/service/tracker/vision.js',
    '/script/enemy/type/abstract-enemy.js',
    '/script/enemy/type/grabber.js',
    '/script/enemy/type/normal-enemy.js',
    '/script/enemy/type/ranger.js',
    '/script/enemy/type/scorcher.js',
    '/script/enemy/type/spiker.js',
    '/script/enemy/type/stinger.js',
    '/script/enemy/type/tracker.js',
    '/script/entities.js',
    '/script/entity-manager.js',
    '/script/finish-up.js',
    '/script/game-over.js',
    '/script/game.js',
    '/script/gun-details.js',
    '/script/gun-examine.js',
    '/script/gun-loader.js',
    '/script/interactables.js',
    '/script/inventory.js',
    '/script/knock-manager.js',
    '/script/loader.js',
    '/script/loot-manager.js',
    '/script/loot.js',
    '/script/main-menu.js',
    '/script/mapMaker/attributes/dialogue.js',
    '/script/mapMaker/attributes/enemy',
    '/script/mapMaker/attributes/enemy/enemy.js',
    '/script/mapMaker/attributes/enemy/waypoints.js',
    '/script/mapMaker/attributes/interactable.js',
    '/script/mapMaker/attributes/loader.js',
    '/script/mapMaker/attributes/loot.js',
    '/script/mapMaker/attributes/popup.js',
    '/script/mapMaker/attributes/room.js',
    '/script/mapMaker/attributes/shared.js',
    '/script/mapMaker/attributes/shop.js',
    '/script/mapMaker/attributes/wall.js',
    '/script/mapMaker/data-manager.js',
    '/script/mapMaker/elements.js',
    '/script/mapMaker/map-maker.js',
    '/script/mapMaker/variables.js',
    '/script/new-game.js',
    '/script/password-manager.js',
    '/script/path.js',
    '/script/pause-menu.js',
    '/script/player-health.js',
    '/script/player-movement.js',
    '/script/player-sprint.js',
    '/script/popup-manager.js',
    '/script/progress-manager.js',
    '/script/progress.js',
    '/script/room-loader.js',
    '/script/room-name-manager.js',
    '/script/room.js',
    '/script/script.js',
    '/script/settings.js',
    '/script/shop-item.js',
    '/script/sound-manager.js',
    '/script/startup.js',
    '/script/stash.js',
    '/script/survival/chaos-manager.js',
    '/script/survival/data-manager.js',
    '/script/survival/spawn-manager.js',
    '/script/survival/variables.js',
    '/script/sw.js',
    '/script/throwable-details.js',
    '/script/throwable-loader.js',
    '/script/torch-loader.js',
    '/script/user-interface.js',
    '/script/util.js',
    '/script/variables.js',
    '/script/vending-machine.js',
    '/script/wall.js',
    '/script/weapon-manager.js',
    '/style/animations.css',
    '/style/computer.css',
    '/style/enemies.css',
    '/style/fonts.css',
    '/style/game-over.css',
    '/style/interactables.css',
    '/style/inventory.css',
    '/style/main-menu.css',
    '/style/map-maker.css',
    '/style/map.css',
    '/style/password.css',
    '/style/player.css',
    '/style/settings.css',
    '/style/stash.css',
    '/style/style.css',
    '/style/user-interface.css',
    '/style/vending-machine.css',
]

self.addEventListener('install', event => {
    event.waitUntil(
        caches.open(VERSION).then(cache => {
            return cache.addAll(contentToCache)
        }),
    )
})

self.addEventListener('fetch', e => {
    e.respondWith(
        (async () => {
            const r = await caches.match(e.request)
            if (r) {
                return r
            }
            const response = await fetch(e.request)
            const cache = await caches.open(VERSION)
            cache.put(e.request, response.clone())
            return response
        })(),
    )
})

self.addEventListener('activate', e => {
    e.waitUntil(
        caches.keys().then(keyList => {
            return Promise.all(
                keyList.map(key => {
                    if (key === VERSION) {
                        return
                    }
                    return caches.delete(key)
                }),
            )
        }),
    )
})
